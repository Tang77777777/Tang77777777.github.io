<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>苍穹外卖 —— 开发日记(其一) | Tang_7777777 的博客</title><meta name="author" content="Tang_7777777"><meta name="copyright" content="Tang_7777777"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="nginx 的反向代理前端发送的请求，是如何请求到后端服务的？ nginx 的反向代理，就是将前端发送的动态请求由 nginx 转发到后端服务器 nginx 反向代理的好处：  提高访问速度  进行负载均衡，所谓的负载均衡，就是把大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器   使用MD5信息摘要算法完善登录功能 &amp;#8195对数据库中存储的账户密码进行处理,首先修改数据库中的明">
<meta property="og:type" content="article">
<meta property="og:title" content="苍穹外卖 —— 开发日记(其一)">
<meta property="og:url" content="http://tang7777777.com/2024/09/08/CangQWoking/index.html">
<meta property="og:site_name" content="Tang_7777777 的博客">
<meta property="og:description" content="nginx 的反向代理前端发送的请求，是如何请求到后端服务的？ nginx 的反向代理，就是将前端发送的动态请求由 nginx 转发到后端服务器 nginx 反向代理的好处：  提高访问速度  进行负载均衡，所谓的负载均衡，就是把大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器   使用MD5信息摘要算法完善登录功能 &amp;#8195对数据库中存储的账户密码进行处理,首先修改数据库中的明">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://tang7777777.com/img/check.jpg">
<meta property="article:published_time" content="2024-09-08T06:59:51.000Z">
<meta property="article:modified_time" content="2024-09-22T15:02:24.666Z">
<meta property="article:author" content="Tang_7777777">
<meta property="article:tag" content="Java开发">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://tang7777777.com/img/check.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://tang7777777.com/2024/09/08/CangQWoking/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '苍穹外卖 —— 开发日记(其一)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-22 23:02:24'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/check.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间戳</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="Tang_7777777 的博客"><span class="site-name">Tang_7777777 的博客</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间戳</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">苍穹外卖 —— 开发日记(其一)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-08T06:59:51.000Z" title="发表于 2024-09-08 14:59:51">2024-09-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-22T15:02:24.666Z" title="更新于 2024-09-22 23:02:24">2024-09-22</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="苍穹外卖 —— 开发日记(其一)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><body>

<h2 id="nginx-的反向代理"><a href="#nginx-的反向代理" class="headerlink" title="nginx 的反向代理"></a>nginx 的反向代理</h2><h3 id="前端发送的请求，是如何请求到后端服务的？"><a href="#前端发送的请求，是如何请求到后端服务的？" class="headerlink" title="前端发送的请求，是如何请求到后端服务的？"></a>前端发送的请求，是如何请求到后端服务的？</h3><p>
nginx 的反向代理，就是将前端发送的动态请求由 nginx 转发到后端服务器
nginx 反向代理的好处：
<br>
提高访问速度
<br>
进行负载均衡，所谓的负载均衡，就是把大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器
</p>

<h2 id="使用MD5信息摘要算法完善登录功能"><a href="#使用MD5信息摘要算法完善登录功能" class="headerlink" title="使用MD5信息摘要算法完善登录功能"></a>使用MD5信息摘要算法完善登录功能</h2><p>
&#8195对数据库中存储的账户密码进行处理,首先修改数据库中的明文密码，改为MD5加密后的密文。
<br>
&#8195修改Java代码，前端提交的密码进行MD5加密后再跟数据库中的密码对比,包括学校教务系统也是这个逻辑进行
实现的（我猜的，因为每次输入完密码之后点击登录我的密码都会变成一长串）。并且java中自带MD5识别函数：DigestUtils.md5DigestAsHex
<br>
代码实现：

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//md5加密对比</span><br><span class="line">        password = DigestUtils.md5DigestAsHex(password.getBytes());</span><br></pre></td></tr></table></figure>

<h2 id="导入接口文档"><a href="#导入接口文档" class="headerlink" title="导入接口文档"></a>导入接口文档</h2><p>使用 Swagger 你只需要按照它的规范去定义接口及接口相关的信息，就可以做到生成接口文档，以及在线接口调试页面。，<a target="_blank" rel="noopener" href="https://app.apifox.com/main/teams/2897962?tab=project">[链接]</a><br>导入接口可以进行更好的测试。Knife4j 是为 Java MVC 框架集成 Swagger 生成 Api 文档的增强解决方案。<br><br><br>Yap i是设计阶段使用的工具，管理和维护接口。Swagger在开发阶段使用的框架，帮助后端开发人员做后端的接口测试。</p>
<h2 id="使用Swagger方法"><a href="#使用Swagger方法" class="headerlink" title="使用Swagger方法"></a>使用Swagger方法</h2><p>Swagger作用为进行后端测试的常用工具.<br><br><br>首先导入knife4j的maven坐标,再在配置类中加入knife4j相关配置，然后设置静态资源映射，否则接口文档页面无法访问<br>在本项目中的实现:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 通过knife4j生成接口文档</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    public Docket docket() &#123;</span><br><span class="line">        ApiInfo apiInfo = new ApiInfoBuilder()</span><br><span class="line">                .title(&quot;苍穹外卖项目接口文档&quot;)</span><br><span class="line">                .version(&quot;2.0&quot;)</span><br><span class="line">                .description(&quot;苍穹外卖项目接口文档&quot;)</span><br><span class="line">                .build();</span><br><span class="line">        Docket docket = new Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(apiInfo)</span><br><span class="line">                .select()</span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(&quot;com.sky.controller&quot;))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">        return docket;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 设置静态资源映射</span><br><span class="line">     * @param registry</span><br><span class="line">     */</span><br><span class="line">    protected void addResourceHandlers(ResourceHandlerRegistry registry) &#123;</span><br><span class="line">        registry.addResourceHandler(&quot;/doc.html&quot;).addResourceLocations(&quot;classpath:/META-INF/resources/&quot;);</span><br><span class="line">        registry.addResourceHandler(&quot;/webjars/**&quot;).addResourceLocations(&quot;classpath:/META-INF/resources/webjars/&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>其中在设置静态资源映射部分，我们可以看到它是从哪个路径来找到生成的接口文档的，即 <a target="_blank" rel="noopener" href="http://localhost:8080/doc.html">[链接]</a><br>如果没有设置静态资源映射的话我们就会打不开整个接口文档网站，因为其并不会将其当成静态网页处理而是动态控制命令。</p>
<br>

<p>常用注解<br>通过一些注解，我们可以来控制生成的接口文档，使接口文档拥有更好的可读性，常用注解如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   </span><br><span class="line"></span><br><span class="line">@Api :用在类上，例如Controller，表示对类的说明@ApiModel</span><br><span class="line"></span><br><span class="line">@ApiModel    :用在类上，例如entity、DTO、VO @ApiModelProperty</span><br><span class="line"></span><br><span class="line">@ApiModelProperty     :用在属性上，描述属性信息@ApiOperation</span><br><span class="line"></span><br><span class="line">@ApiOperation   :用在方法上，例如Controller的方法，说明方法的用途、作用</span><br></pre></td></tr></table></figure>

</p>

<h2 id="员工管理模块"><a href="#员工管理模块" class="headerlink" title="员工管理模块"></a>员工管理模块</h2><p>

<h3 id="需求分析："><a href="#需求分析：" class="headerlink" title="需求分析："></a>需求分析：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">账号必须是唯一的</span><br><span class="line">手机号为合法的 11 位手机号码</span><br><span class="line">身份证号为合法的 18 位身份证号码</span><br><span class="line">注意到表单项中没有 “密码” ，这里我们约定，新增员工时会默认员工密码为 123456，后续员工可以自行修改密码</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="设计："><a href="#设计：" class="headerlink" title="设计："></a>设计：</h3><br>
因为我们是前后端分离开发，所以我们必须先设计好接口后，才能进行前后端的开发。在接口设计中，我们需要考虑请求的路径以及请求的
类型；同时，我们需要定义前端需要传给后端的参数，以及后端返回给前端的数据格式。 由于本项目分为管理端和用户端，所以统一规定：
<br>
管理端发出的请求，统一使用 /admin 作为前缀
<br>
用户端发出的请求，统一使用 /user 作为前缀

<p>代码开发:<br><br><br>根据新增员工接口设计对应的DTO：<br>注意：当前端提交的数据和实体类中对应的属性差别比较大时，建议使用DTO来封装数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">@Data</span><br><span class="line"></span><br><span class="line">public class EmployeeDTO implements Serializable </span><br><span class="line">&#123;</span><br><span class="line">    private Long id;</span><br><span class="line">    </span><br><span class="line">    private String username; </span><br><span class="line">    </span><br><span class="line">    private String name; </span><br><span class="line">    </span><br><span class="line">    private String phone; </span><br><span class="line">    </span><br><span class="line">    private String sex;</span><br><span class="line">    </span><br><span class="line">    private String idNumber; </span><br><span class="line">&#125;</span><br><span class="line">在 EmployeeController 中创建新增员工方法，接收前端提交的参数：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 新增员工</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PostMapping</span><br><span class="line">@ApiOperation(&quot;新增员工接口&quot;)</span><br><span class="line">public Result save(@RequestBody EmployeeDTO employeeDTO) &#123;</span><br><span class="line">    log.info(&quot;新增员工：&#123;&#125;&quot;, employeeDTO);</span><br><span class="line">    employeeService.save(employeeDTO);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeService 接口中声明新增员工方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 新增员工</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> */</span><br><span class="line">void save(EmployeeDTO employeeDTO);</span><br><span class="line"></span><br><span class="line">在 EmployeeServiceImpl 中实现新增员工方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 新增员工</span><br><span class="line"> *</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> */</span><br><span class="line">public void save(EmployeeDTO employeeDTO) &#123;</span><br><span class="line">    //定义员工对象</span><br><span class="line">    Employee employee = new Employee();</span><br><span class="line"></span><br><span class="line">    //对象属性拷贝: 将employeeDTO的属性拷贝给employee</span><br><span class="line">    BeanUtils.copyProperties(employeeDTO, employee);</span><br><span class="line"></span><br><span class="line">    //账号状态默认为1, 正常状态</span><br><span class="line">    employee.setStatus(StatusConstant.ENABLE);</span><br><span class="line"></span><br><span class="line">    //默认密码为123456</span><br><span class="line">    employee.setPassword(DigestUtils.md5DigestAsHex(PasswordConstant.DEFAULT_PASSWORD.getBytes()));</span><br><span class="line"></span><br><span class="line">    //设置当前记录的创建时间和修改时间</span><br><span class="line">    employee.setCreateTime(LocalDateTime.now());</span><br><span class="line">    employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">    //设置当前记录创建人id和修改人id</span><br><span class="line">    //由于仅凭当前的技术还无法获取这两个id, 所以我们先给它一个固定值</span><br><span class="line">    employee.setCreateUser(10L);</span><br><span class="line">    employee.setUpdateUser(10L);</span><br><span class="line"></span><br><span class="line">    employeeMapper.insert(employee);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeMapper 中声明 insert 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 插入员工数据</span><br><span class="line"> * @param employee</span><br><span class="line"> */</span><br><span class="line">@Insert(&quot;insert into employee&quot; +</span><br><span class="line">        &quot;(name, username, password, phone, sex, id_number, status, create_time, update_time, create_user, update_user) &quot; +</span><br><span class="line">        &quot;VALUES &quot; +</span><br><span class="line">        &quot;(#&#123;name&#125;,#&#123;username&#125;,#&#123;password&#125;,#&#123;phone&#125;,#&#123;sex&#125;,#&#123;idNumber&#125;,#&#123;status&#125;,#&#123;createTime&#125;,#&#123;updateTime&#125;,#&#123;createUser&#125;,#&#123;updateUser&#125;)&quot;)</span><br><span class="line">void insert(Employee employee);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</p>

<h3 id="功能测试"><a href="#功能测试" class="headerlink" title="功能测试"></a>功能测试</h3><p>功能测试方式： 通过接口文档测试  , 通过前后端联调测试.</p>
<p>测试完成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">代码完善</span><br><span class="line">程序存在的问题：</span><br><span class="line">录入的用户名已存在，抛出异常后没有处理</span><br><span class="line">新增员工时，创建人id和修改人id的设置</span><br></pre></td></tr></table></figure>
<p>针对第一个问题，可以通过全局异常处理器来处理：<br><br><br>添加代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 捕获sql异常</span><br><span class="line"> *</span><br><span class="line"> * @param ex</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@ExceptionHandler</span><br><span class="line">public Result exceptionHandler(SQLIntegrityConstraintViolationException ex) &#123;</span><br><span class="line">    log.info(&quot;异常信息：&#123;&#125;&quot;, ex.getMessage());   //即 Duplicate entry &#x27;zhangsan&#x27; for key &#x27;employee.idx_username&#x27;</span><br><span class="line">    String message = ex.getMessage();</span><br><span class="line">    if (message.contains(&quot;Duplicate entry&quot;)) &#123;</span><br><span class="line">        String[] split = message.split(&quot; &quot;);</span><br><span class="line">        String username = split[2]; //获取传进来的用户名</span><br><span class="line">        return Result.error(username + MessageConstant.ALREADY_EXITS);//这部分有问题，无法使用MessageConstant.ALREADY_EXITS</span><br><span class="line">    &#125;</span><br><span class="line">    return Result.error(MessageConstant.UNKNOWN_ERROR);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>针对第二个问题，我们需要通过某种方式来动态获取当前登录员工的 id：<br><br><br>员工登录成功后会生成 JWT 令牌并响应给前端,后续请求中，前端会携带 JWT 令牌，通过 JWT 令牌可以解析出当前登录员工 id，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">解决方法——使用ThreadLocal</span><br><span class="line"></span><br><span class="line">ThreadLocal 并不是一个 Thread，而是 Thread 的局部变量。</span><br><span class="line">ThreadLocal 为每个线程提供单独一份存储空间，具有线程隔离的效果，只有在线程内才能获取到对应的值，线程外则不能访问。</span><br><span class="line">注意：客户端发送的每次请求，后端的 Tomcat 服务器都会分配一个单独的线程来处理请求，所以这里我们才能使用 ThreadLocal 来处理。</span><br><span class="line"></span><br><span class="line">ThreadLocal 常用方法：</span><br><span class="line"></span><br><span class="line">public void set(T value) ：设置当前线程的线程局部变量的值</span><br><span class="line">public T get()：返回当前线程所对应的线程局部变量的值</span><br><span class="line">public void remove()：移除当前线程的线程局部变量</span><br><span class="line">初始工程中已经封装了 ThreadLocal 操作的工具类，方便我们后续使用</span><br><span class="line">完善代码</span><br><span class="line">在拦截器中解析出当前登录员工 id，并放入线程局部变量中</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="员工分页查询"><a href="#员工分页查询" class="headerlink" title="员工分页查询"></a>员工分页查询</h2><h3 id="需求分析和设计"><a href="#需求分析和设计" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line"></span><br><span class="line">根据页码展示员工信息</span><br><span class="line">每页展示 10 条数据</span><br><span class="line">分页查询时可以根据需要，输入员工姓名进行查询</span><br></pre></td></tr></table></figure>
<h3 id="代码开发"><a href="#代码开发" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">根据分页查询接口设计对应的 DTO，这个 DTO 在初始工程中已经定义：</span><br><span class="line">请求参数格式为 Query，不是 json</span><br><span class="line">后面所有的分页查询，统一都封装成 PageResult 对象</span><br><span class="line">员工信息分页查询后端返回的对象类型为：Result&lt;PageResult&gt;</span><br><span class="line">根据接口定义创建分页查询方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 员工分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param employeePageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/page&quot;)</span><br><span class="line">@ApiOperation(&quot;员工分页查询&quot;)</span><br><span class="line">public Result&lt;PageResult&gt; page(EmployeePageQueryDTO employeePageQueryDTO) &#123; //不是json格式的数据, 不能加@RequestBody</span><br><span class="line">    log.info(&quot;员工分页查询，参数：&#123;&#125;&quot;, employeePageQueryDTO);</span><br><span class="line">    PageResult pageResult = employeeService.pageQuery(employeePageQueryDTO);</span><br><span class="line">    return Result.success(pageResult);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeService 接口中声明 pageQuery 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param employeePageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">PageResult pageQuery(EmployeePageQueryDTO employeePageQueryDTO);</span><br><span class="line"></span><br><span class="line">在 EmployeeServiceImpl 中实现 pageQuery 方法：</span><br><span class="line">/**</span><br><span class="line"> * 分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param employeePageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public PageResult pageQuery(EmployeePageQueryDTO employeePageQueryDTO) &#123;</span><br><span class="line">    //开始分页查询</span><br><span class="line">    PageHelper.startPage(employeePageQueryDTO.getPage(), employeePageQueryDTO.getPageSize());</span><br><span class="line"></span><br><span class="line">    Page&lt;Employee&gt; page = employeeMapper.pageQuery(employeePageQueryDTO);</span><br><span class="line">    return new PageResult(page.getTotal(), page.getResult());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">注意：此处使用了 mybatis 的分页插件 PageHelper 来简化分页代码的开发，底层基于 mybatis 的拦截器实现。</span><br><span class="line"></span><br><span class="line">所需依赖已添加</span><br></pre></td></tr></table></figure>
<p>功能测试<br>可以通过接口文档进行测试，也可以进行前后端联调测试，测试过程中发现最后操作时间字段展示有问题，就是时间的格式好像不太对</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">代码完善</span><br><span class="line">解决方式：</span><br><span class="line">方式一：在属性上加入注解，对日期进行格式化</span><br><span class="line">@JsonFormat (pattern &quot;yyyy-MM-dd HH: mm: ss&quot;) private LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">方式二：在 WebMvcConfiguration 中扩展 SpringMVC 的消息转换器，统一对日期类型进行格式化处理</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 扩Spring MVC框架的消息转换器</span><br><span class="line"> *</span><br><span class="line"> * @param converters</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">protected void extendMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123;</span><br><span class="line">    log.info(&quot;扩展消息转换器...&quot;);</span><br><span class="line">    //创建一个消息转换器对象</span><br><span class="line">    MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter();</span><br><span class="line"></span><br><span class="line">    //需要为消息转换器设置一个对象转换器，对象转换器可以将Java对象序列化为json数据</span><br><span class="line">    //JacksonObjectMapper在com.sky.json中已存在</span><br><span class="line">    converter.setObjectMapper(new JacksonObjectMapper());</span><br><span class="line"></span><br><span class="line">    //将自己的消息转换器加入容器中，并设置为第一位</span><br><span class="line">    converters.add(0, converter);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如果想具体到秒，可以在对象转换器 JacksonObjectMapper 中修改。</p>
<h2 id="启动禁用员工账号"><a href="#启动禁用员工账号" class="headerlink" title="启动禁用员工账号"></a>启动禁用员工账号</h2><h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line">可以对状态为 “启用” 的员工账号进行 “禁用” 操作</span><br><span class="line">可以对状态为 “禁用” 的员工账号进行 “启用” 操作</span><br><span class="line">状态为 “禁用” 的员工账号不能登录系统</span><br></pre></td></tr></table></figure>
<h3 id="代码开发-1"><a href="#代码开发-1" class="headerlink" title="代码开发"></a>代码开发</h3><p>根据接口设计中的请求参数形式，对应在 EmployeeController 中创建启用禁用员工账号的方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 启动禁用员工账号</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span><br><span class="line">@ApiOperation(&quot;启动禁用员工账号&quot;)</span><br><span class="line">public Result startOrStop(@PathVariable Integer status, Long id) &#123;//由于变量名相同, 所以注解中不用指定使用哪个路径参数</span><br><span class="line">    log.info(&quot;启动禁用员工账号：&#123;&#125;, &#123;&#125;&quot;, status, id);</span><br><span class="line"></span><br><span class="line">    employeeService.startOrStop(status, id);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeService 接口中声明启用禁用员工账号的业务方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 启动禁用员工账号</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @param id</span><br><span class="line"> */</span><br><span class="line">void startOrStop(Integer status, Long id);</span><br><span class="line"></span><br><span class="line">在 EmployeeServiceImpl 中实现启用禁用员工账号的业务方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 启动禁用员工账号</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @param id</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void startOrStop(Integer status, Long id) &#123;</span><br><span class="line">    //方式一：可以直接new一个Employee, 再设置id和status</span><br><span class="line"></span><br><span class="line">    //方式二：因为Employee类中已经添加了@Builder注解,所以可以使用builder</span><br><span class="line">    Employee employee = Employee.builder()</span><br><span class="line">            .id(id)</span><br><span class="line">            .status(status)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    employeeMapper.update(employee);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeMapper 接口中声明 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id修改员工信息</span><br><span class="line"> *</span><br><span class="line"> * @param employee</span><br><span class="line"> */</span><br><span class="line">void update(Employee employee);</span><br><span class="line"></span><br><span class="line">在 EmployeeMapper.xml 中编写 SQL：</span><br><span class="line"></span><br><span class="line">&lt;!-- 参数类型可以不指定具体包名, 因为在配置文件中我们已经指定了扫描的包为com.sky.entity--&gt;</span><br><span class="line">&lt;update id=&quot;update&quot; parameterType=&quot;Employee&quot;&gt;</span><br><span class="line">    update employee</span><br><span class="line">    &lt;set&gt;</span><br><span class="line">        &lt;if test=&quot;username != null&quot;&gt;username = #&#123;username&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;name != null&quot;&gt;name = #&#123;name&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;password != null&quot;&gt;password = #&#123;password&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;phone != null&quot;&gt;phone = #&#123;phone&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;sex != null&quot;&gt;sex = #&#123;sex&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;idNumber != null&quot;&gt;id_Number = #&#123;idNumber&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;updateTime != null&quot;&gt;update_Time = #&#123;updateTime&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;updateUser != null&quot;&gt;update_User = #&#123;updateUser&#125;,&lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;status != null&quot;&gt;status = #&#123;status&#125;&lt;/if&gt;</span><br><span class="line">    &lt;/set&gt;</span><br><span class="line">    where id = #&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="编辑员工"><a href="#编辑员工" class="headerlink" title="编辑员工"></a>编辑员工</h2><h3 id="需求分析与设计"><a href="#需求分析与设计" class="headerlink" title="需求分析与设计"></a>需求分析与设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">接口设计：</span><br><span class="line"></span><br><span class="line">编辑员工功能涉及到两个接口：</span><br><span class="line">根据 id 查询员工信息</span><br><span class="line">编辑员工信息</span><br></pre></td></tr></table></figure>

<h3 id="代码开发-2"><a href="#代码开发-2" class="headerlink" title="代码开发"></a>代码开发</h3><h4 id="根据id查询员工信息接口开发"><a href="#根据id查询员工信息接口开发" class="headerlink" title="根据id查询员工信息接口开发"></a>根据id查询员工信息接口开发</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">在 EmployeeController 中创建 getById 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询员工</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">@ApiOperation(&quot;根据id查询员工&quot;)</span><br><span class="line">public Result&lt;Employee&gt; getById(@PathVariable Long id) &#123;</span><br><span class="line">    log.info(&quot;根据id查询员工：&#123;&#125;&quot;, id);</span><br><span class="line">    return Result.success(employeeService.getById(id));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeService 接口中声明 getById 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询员工</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">Employee getById(Long id);</span><br><span class="line"></span><br><span class="line">在 EmployeeServiceImpl 中实现 getById 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询员工</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public Employee getById(Long id) &#123;</span><br><span class="line">    Employee employee = employeeMapper.getById(id);</span><br><span class="line">    employee.setPassword(&quot;****&quot;);   //设置一下密码, 防止他人通过开发者控制台获取密码</span><br><span class="line"></span><br><span class="line">    return employee;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeMapper 接口中声明 getById 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 根据id查询员工信息</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@Select(&quot;select * from employee where id = #&#123;id&#125;&quot;)</span><br><span class="line">Employee getById(Long id);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="编辑员工信息接口开发"><a href="#编辑员工信息接口开发" class="headerlink" title="编辑员工信息接口开发"></a>编辑员工信息接口开发</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">在 EmployeeController 中创建 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 编辑员工信息</span><br><span class="line"> *</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PutMapping</span><br><span class="line">@ApiOperation(&quot;编辑员工信息&quot;)</span><br><span class="line">public Result update(@RequestBody EmployeeDTO employeeDTO) &#123;</span><br><span class="line">    log.info(&quot;编辑员工：&#123;&#125;&quot;, employeeDTO);</span><br><span class="line">    employeeService.update(employeeDTO);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 EmployeeService 接口中声明 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id修改员工信息</span><br><span class="line"> *</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> */</span><br><span class="line">void update(EmployeeDTO employeeDTO);</span><br><span class="line"></span><br><span class="line">在 EmployeeServiceImpl 中实现 update 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 根据id修改员工信息</span><br><span class="line"> *</span><br><span class="line"> * @param employeeDTO</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public void update(EmployeeDTO employeeDTO) &#123;</span><br><span class="line">    //拷贝对象属性</span><br><span class="line">    Employee employee = new Employee();</span><br><span class="line">    BeanUtils.copyProperties(employeeDTO, employee);</span><br><span class="line"></span><br><span class="line">    //设置修改人和修改时间</span><br><span class="line">    employee.setUpdateUser(BaseContext.getCurrentId());</span><br><span class="line">    employee.setUpdateTime(LocalDateTime.now());</span><br><span class="line"></span><br><span class="line">	//使用前面开发好的update方法</span><br><span class="line">    employeeMapper.update(employee);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="导入分类模块功能代码"><a href="#导入分类模块功能代码" class="headerlink" title="导入分类模块功能代码"></a>导入分类模块功能代码</h2><h3 id="需求分析-1"><a href="#需求分析-1" class="headerlink" title="需求分析"></a>需求分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">产品原型:</span><br><span class="line">业务规则：</span><br><span class="line"></span><br><span class="line">分类名称必须是唯一的</span><br><span class="line">分类按照类型可以分为菜品分类和套餐分类</span><br><span class="line">新添加的分类状态默认为 “禁用”</span><br><span class="line">接口设计：</span><br><span class="line"></span><br><span class="line">新增分类</span><br><span class="line">分类分页查询</span><br><span class="line">根据 id 删除分类</span><br><span class="line">修改分类</span><br><span class="line">启用禁用分类</span><br><span class="line">根据类型查询分类</span><br><span class="line">代码导入</span><br><span class="line">从技术层面上来看，分类管理模块和员工管理模块其实是非常类似的。除了操作的表不一样，实际上都是对单个表的增删改查，技术难度是差不多的，所以关于分类管理的代码我们就不再细讲，直接导入即可，小伙伴有不懂的地方也可以在评论区提出来。</span><br><span class="line"></span><br><span class="line">在第二天的资料中找到分类管理的代码，导入即可</span><br><span class="line">导入的时候可以按照从后往前的顺序导入，这样代码不会报错</span><br><span class="line"></span><br><span class="line">导入完，手动编译一下，导入的类有时候不会自动编译</span><br></pre></td></tr></table></figure>
<h2 id="公共字段自动填充"><a href="#公共字段自动填充" class="headerlink" title="公共字段自动填充"></a>公共字段自动填充</h2><h3 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h3><p>在前面的业务表中，比如表 employee 和 category 中，我们可以发现一些公共字段，这些字段在后面的业务表中也同样存在：这些公共字段在某些操作中都需要设置，<br>而且设置的代码都是一样的这些公共字段在某些操作中都需要设置，而且设置的代码都是一样的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">那么就出现了问题：代码冗余、不便于后期维护</span><br><span class="line"></span><br><span class="line">工程中存在多段相同的代码</span><br><span class="line">如果后期我们需要对业务表进行修改，涉及到这些公共字段，进行修改也是非常麻烦的</span><br></pre></td></tr></table></figure>

<h3 id="解决思路"><a href="#解决思路" class="headerlink" title="解决思路"></a>解决思路</h3><p>我们发现，这些公共字段的设置只会出现在特定的操作中，比如 create_time 和 create_user 只会出现在 insert 操作中。所以，我们的想法是将其统一处理。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">具体思路：</span><br><span class="line"></span><br><span class="line">自定义注解 AutoFill，用于标识需要进行公共字段自动填充的方法</span><br><span class="line">自定义切面类 AutoFillAspect，统一拦截加入了 AutoFill 注解的方法，通过反射为公共字段赋值</span><br><span class="line">在 Mapper 中需要处理公共字段的方法上加入 AutoFill 注解</span><br><span class="line">涉及技术点：枚举、注解、AOP、反射</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="代码开发-3"><a href="#代码开发-3" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">创建一个专门用来存放自定义注解的包 annotation，在包下创建自定义注解 AutoFill</span><br><span class="line">import com.sky.enumeration.OperationType;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.ElementType;</span><br><span class="line">import java.lang.annotation.Retention;</span><br><span class="line">import java.lang.annotation.RetentionPolicy;</span><br><span class="line">import java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line">@Target(ElementType.METHOD) //只作用于方法上</span><br><span class="line">@Retention(RetentionPolicy.RUNTIME) //表示被该注解修饰的注解在运行时保留，即可以通过反射机制在运行时获取这些注解的信息</span><br><span class="line">public @interface AutoFill &#123;</span><br><span class="line">    //定义注解的属性为数据库操作类型: UPDATE INSERT</span><br><span class="line">    //OperationType在包com.sky.enumeration中</span><br><span class="line">    OperationType value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">创建一个专门用来存放切面类的包 aspect，在包下创建切面类 AutoFillAspect</span><br><span class="line">import com.sky.annotation.AutoFill;</span><br><span class="line">import com.sky.constant.AutoFillConstant;</span><br><span class="line">import com.sky.context.BaseContext;</span><br><span class="line">import com.sky.enumeration.OperationType;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.aspectj.lang.JoinPoint;</span><br><span class="line">import org.aspectj.lang.annotation.Aspect;</span><br><span class="line">import org.aspectj.lang.annotation.Before;</span><br><span class="line">import org.aspectj.lang.annotation.Pointcut;</span><br><span class="line">import org.aspectj.lang.reflect.MethodSignature;</span><br><span class="line">import org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line">import java.lang.reflect.Method;</span><br><span class="line">import java.time.LocalDateTime;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 自定义切面，实现公共字段自动填充处理逻辑</span><br><span class="line"> */</span><br><span class="line">@Aspect     //切面类</span><br><span class="line">@Component  //标记为Spring管理的Bean</span><br><span class="line">@Slf4j      //日志</span><br><span class="line">public class AutoFillAspect &#123;</span><br><span class="line">    //切入点</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * execution(* com.sky.mapper.*.*(..)): 切点表达式, 方法返回值为任意, 匹配com.sky.mapper包下所有类和接口,</span><br><span class="line">     * 参数为任意</span><br><span class="line">     *</span><br><span class="line">     * @annotation(com.sky.annotation.AutoFill): 注解匹配表达式, 拦截带有AutoFill注解的方法</span><br><span class="line">     */</span><br><span class="line">    @Pointcut(&quot;execution(* com.sky.mapper.*.*(..)) &amp;&amp; @annotation(com.sky.annotation.AutoFill)&quot;)</span><br><span class="line">    public void autoFillPointCut() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 前置通知：在通知中进行公共字段的赋值</span><br><span class="line">     *</span><br><span class="line">     * @param joinPoint</span><br><span class="line">     */</span><br><span class="line">    @Before(&quot;autoFillPointCut()&quot;)</span><br><span class="line">    public void autoFill(JoinPoint joinPoint) &#123;</span><br><span class="line">        log.info(&quot;公共字段自动填充...&quot;);</span><br><span class="line"></span><br><span class="line">        //获取到当前被拦截的方法上的数据库操作类型</span><br><span class="line">        MethodSignature signature = (MethodSignature) joinPoint.getSignature();     //方法的签名对象</span><br><span class="line">        AutoFill autoFill = signature.getMethod().getAnnotation(AutoFill.class);    //获取方法上的注解对象</span><br><span class="line">        OperationType operationType = autoFill.value();                             //获取数据库操作类型</span><br><span class="line"></span><br><span class="line">        //获取到当前被拦截的方法的参数——实体对象, 我们约定在定义方法时, 实体对象放在第一位</span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line">        if (args == null || args.length == 0) return;</span><br><span class="line"></span><br><span class="line">        Object entity = args[0];  //获取实体对象</span><br><span class="line"></span><br><span class="line">        //准备赋值的数据</span><br><span class="line">        LocalDateTime now = LocalDateTime.now();</span><br><span class="line">        Long currentId = BaseContext.getCurrentId();</span><br><span class="line"></span><br><span class="line">        //根据当前不同的操作类型, 为对应的属性通过反射来赋值</span><br><span class="line">        if (operationType == OperationType.INSERT) &#123;</span><br><span class="line">            //当前执行的是insert操作, 为4个字段赋值</span><br><span class="line">            try &#123;</span><br><span class="line">                //获取set方法对象——Method</span><br><span class="line">                Method setCreateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_TIME, LocalDateTime.class);</span><br><span class="line">                Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">                Method setCreateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_CREATE_USER, Long.class);</span><br><span class="line">                Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">                //通过反射调用目标对象的方法</span><br><span class="line">                setCreateTime.invoke(entity, now);</span><br><span class="line">                setUpdateTime.invoke(entity, now);</span><br><span class="line">                setCreateUser.invoke(entity, currentId);</span><br><span class="line">                setUpdateUser.invoke(entity, currentId);</span><br><span class="line">            &#125; catch (Exception e) &#123;</span><br><span class="line">                log.info(&quot;公共字段自动填充失败：&#123;&#125;&quot;, e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if (operationType == OperationType.UPDATE) &#123;</span><br><span class="line">            //当前执行的是update操作, 为2个字段赋值</span><br><span class="line">            try &#123;</span><br><span class="line">                //获取set方法对象——Method</span><br><span class="line">                Method setUpdateTime = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_TIME, LocalDateTime.class);</span><br><span class="line">                Method setUpdateUser = entity.getClass().getDeclaredMethod(AutoFillConstant.SET_UPDATE_USER, Long.class);</span><br><span class="line"></span><br><span class="line">                //通过反射调用目标对象的方法</span><br><span class="line">                setUpdateTime.invoke(entity, now);</span><br><span class="line">                setUpdateUser.invoke(entity, currentId);</span><br><span class="line">            &#125; catch (Exception e) &#123;</span><br><span class="line">                log.info(&quot;公共字段自动填充失败：&#123;&#125;&quot;, e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">给 EmployeeMapper 和 CategoryMapper 中数据库操作类型为 insert 和 update 的方法加上自定义的注解 @AutoFill(value = OperationType.INSERT)，</span><br><span class="line">；然后，原先代码 Service 层中给这些公共字段赋值的代码就可以注解掉了。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="新增菜品"><a href="#新增菜品" class="headerlink" title="新增菜品"></a>新增菜品</h2><h3 id="需求分析和设计-1"><a href="#需求分析和设计-1" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line">菜品名称必须是唯一的</span><br><span class="line">菜品必须属于某个分类下，不能单独存在</span><br><span class="line">新增菜品时可以根据情况选择菜品的口味</span><br><span class="line">每个菜品必须对应一张图片</span><br><span class="line"></span><br><span class="line">接口设计：</span><br><span class="line">根据类型查询分类（已开发）</span><br><span class="line">文件上传</span><br><span class="line">新增菜品</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="代码开发-4"><a href="#代码开发-4" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">import com.sky.properties.AliOssProperties;</span><br><span class="line">import com.sky.utils.AliOssUtil;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;</span><br><span class="line">import org.springframework.context.annotation.Bean;</span><br><span class="line">import org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line">@Configuration  //配置类</span><br><span class="line">@Slf4j</span><br><span class="line">public class OssConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 通过spring管理对象</span><br><span class="line">     *</span><br><span class="line">     * @param aliOssProperties</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Bean</span><br><span class="line">    @ConditionalOnMissingBean   //只有当容器中不存在名为aliOssUtil的Bean时才创建该Bean, 防止重复创建</span><br><span class="line">    public AliOssUtil aliOssUtil(AliOssProperties aliOssProperties) &#123;</span><br><span class="line">        log.info(&quot;开始创建阿里云OSS工具类对象...&quot;);</span><br><span class="line">        return new AliOssUtil(aliOssProperties.getEndpoint(),</span><br><span class="line">                aliOssProperties.getAccessKeyId(),</span><br><span class="line">                aliOssProperties.getAccessKeySecret(),</span><br><span class="line">                aliOssProperties.getBucketName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CommonController 中:</span><br><span class="line">import com.sky.constant.MessageConstant;</span><br><span class="line">import com.sky.result.Result;</span><br><span class="line">import com.sky.utils.AliOssUtil;</span><br><span class="line">import io.swagger.annotations.Api;</span><br><span class="line">import io.swagger.annotations.ApiOperation;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line">import org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line">import java.util.UUID;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 通用接口</span><br><span class="line"> */</span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/admin/common&quot;)</span><br><span class="line">@Slf4j</span><br><span class="line">@Api(tags = &quot;通用接口&quot;)</span><br><span class="line">public class CommonController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AliOssUtil aliOssUtil;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 文件上传</span><br><span class="line">     *</span><br><span class="line">     * @param file</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @PostMapping(&quot;/upload&quot;)</span><br><span class="line">    @ApiOperation(&quot;文件上传&quot;)</span><br><span class="line">    public Result&lt;String&gt; upload(MultipartFile file) &#123;</span><br><span class="line">        log.info(&quot;文件上传：&#123;&#125;&quot;, file.getName());</span><br><span class="line"></span><br><span class="line">        String originalFilename = file.getOriginalFilename();   //原始文件名</span><br><span class="line">        String extension = originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));   //获取文件后缀</span><br><span class="line"></span><br><span class="line">        //生成一个独一无二的文件名</span><br><span class="line">        String newFileName = UUID.randomUUID().toString() + extension;</span><br><span class="line"></span><br><span class="line">        //将文件上传到阿里云</span><br><span class="line">        try &#123;</span><br><span class="line">            String filePath = aliOssUtil.upload(file.getBytes(), newFileName);</span><br><span class="line">            return Result.success(filePath);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            log.error(&quot;文件上传失败：&#123;&#125;&quot;, e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return Result.error(MessageConstant.UPLOAD_FAILED);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="开发新增菜品接口"><a href="#开发新增菜品接口" class="headerlink" title="开发新增菜品接口"></a>开发新增菜品接口</h4><p>根据新增菜品接口设计对应的DTO</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">新建 DishController，在其中创建新增菜品方法</span><br><span class="line">import com.sky.dto.DishDTO;</span><br><span class="line">import com.sky.result.Result;</span><br><span class="line">import com.sky.service.DishService;</span><br><span class="line">import io.swagger.annotations.Api;</span><br><span class="line">import io.swagger.annotations.ApiOperation;</span><br><span class="line">import lombok.extern.slf4j.Slf4j;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/admin/dish&quot;)</span><br><span class="line">@Api(tags = &quot;菜品相关接口&quot;)</span><br><span class="line">@Slf4j</span><br><span class="line">public class DishController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private DishService dishService;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增菜品</span><br><span class="line">     *</span><br><span class="line">     * @param dishDTO</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @PostMapping</span><br><span class="line">    @ApiOperation(&quot;新增菜品&quot;)</span><br><span class="line">    public Result&lt;String&gt; save(@RequestBody DishDTO dishDTO) &#123;</span><br><span class="line">        log.info(&quot;新增菜品：&#123;&#125;&quot;, dishDTO);</span><br><span class="line">        dishService.saveWithFlavor(dishDTO);</span><br><span class="line">        return Result.success();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 接口中声明新增菜品方法：</span><br><span class="line"></span><br><span class="line">import com.sky.dto.DishDTO;</span><br><span class="line"></span><br><span class="line">public interface DishService &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增菜品和对应的口味</span><br><span class="line">     * @param dishDTO</span><br><span class="line">     */</span><br><span class="line">    void saveWithFlavor(DishDTO dishDTO);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现新增菜品方法：</span><br><span class="line"></span><br><span class="line">import com.sky.dto.DishDTO;</span><br><span class="line">import com.sky.entity.Dish;</span><br><span class="line">import com.sky.entity.DishFlavor;</span><br><span class="line">import com.sky.mapper.DishFlavorMapper;</span><br><span class="line">import com.sky.mapper.DishMapper;</span><br><span class="line">import com.sky.service.DishService;</span><br><span class="line">import org.springframework.beans.BeanUtils;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Service;</span><br><span class="line">import org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Service</span><br><span class="line">public class DishServiceImpl implements DishService &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private DishMapper dishMapper;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private DishFlavorMapper dishFlavorMapper;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 新增菜品和对应的口味</span><br><span class="line">     *</span><br><span class="line">     * @param dishDTO</span><br><span class="line">     */</span><br><span class="line">    @Transactional  //声明方法应该被包含在一个事务中执行</span><br><span class="line">    public void saveWithFlavor(DishDTO dishDTO) &#123;</span><br><span class="line">        Dish dish = new Dish();</span><br><span class="line">        BeanUtils.copyProperties(dishDTO, dish);    //拷贝对象属性</span><br><span class="line"></span><br><span class="line">        //向菜品表dish中插入1条数据</span><br><span class="line">        dishMapper.insert(dish);</span><br><span class="line"></span><br><span class="line">        //获取菜品的主键值</span><br><span class="line">        Long dishId = dish.getId();</span><br><span class="line"></span><br><span class="line">        List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br><span class="line">        if (flavors != null &amp;&amp; flavors.size() &gt; 0) &#123;</span><br><span class="line">            //向口味表dish_flavor插入n条数据</span><br><span class="line">            flavors.forEach(dishFlavor -&gt; &#123;</span><br><span class="line">                dishFlavor.setDishId(dishId);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            //批量插入口味数据</span><br><span class="line">            dishFlavorMapper.insertBatch(flavors);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishMapper 中声明 insert 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 插入菜品数据</span><br><span class="line"> *</span><br><span class="line"> * @param dish</span><br><span class="line"> */</span><br><span class="line">@AutoFill(OperationType.INSERT)</span><br><span class="line">void insert(Dish dish);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 插入菜品数据</span><br><span class="line"> *</span><br><span class="line"> * @param dish</span><br><span class="line"> */</span><br><span class="line">@AutoFill(OperationType.INSERT)</span><br><span class="line">void insert(Dish dish);</span><br><span class="line"></span><br><span class="line">新建 DishMapper.xml，在其中编写对应的 SQL：</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http: //mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;mapper namespace=&quot;com.sky.mapper.DishMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--</span><br><span class="line">       useGeneratedKeys=&quot;true&quot;: 表示获取数据插入后所在的主键值</span><br><span class="line">       keyProperty=&quot;id&quot;: 表示将主键值赋给id属性</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;insert id=&quot;insert&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt;</span><br><span class="line">        insert into dish</span><br><span class="line">        (name, category_id, price, image, description, status, create_time, update_time, create_user, update_user)</span><br><span class="line">        values</span><br><span class="line">        (#&#123;name&#125;, #&#123;categoryId&#125;, #&#123;price&#125;, #&#123;image&#125;, #&#123;description&#125;, #&#123;status&#125;, #&#123;createTime&#125;, #&#123;updateTime&#125;, #&#123;createUser&#125;, #&#123;updateUser&#125;)</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br><span class="line">新建 DishFlavorMapper.xml，在其中编写对应的 SQL：</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http ://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;mapper namespace=&quot;com.sky.mapper.DishFlavorMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;insert id=&quot;insertBatch&quot;&gt;</span><br><span class="line">        insert into dish_flavor(dish_id, name, value) values</span><br><span class="line">        &lt;foreach collection=&quot;flavors&quot; item=&quot;dishFlavor&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">            (#&#123;dishFlavor.dishId&#125;, #&#123;dishFlavor.name&#125;, #&#123;dishFlavor.value&#125;)</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="功能测试-1"><a href="#功能测试-1" class="headerlink" title="功能测试"></a>功能测试</h3><p>进行前后端联调测试，点击菜品管理，添加菜品，可以看到图片，说明文件上传接口开发成功</p>
<h2 id="菜品分页查询"><a href="#菜品分页查询" class="headerlink" title="菜品分页查询"></a>菜品分页查询</h2><h3 id="需求分析和设计-2"><a href="#需求分析和设计-2" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line"></span><br><span class="line">根据页码展示菜品信息</span><br><span class="line">每页展示10条数据</span><br><span class="line">分页查询时可以根据需要输入菜品名称、菜品分类、菜品状态进行查询</span><br></pre></td></tr></table></figure>

<h3 id="代码开发-5"><a href="#代码开发-5" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">根据接口定义创建 DishController 的 page 分页查询方法:</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 菜品分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param dishPageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/page&quot;)</span><br><span class="line">@ApiOperation(&quot;菜品分页查询&quot;)</span><br><span class="line">public Result&lt;PageResult&gt; page(DishPageQueryDTO dishPageQueryDTO) &#123;</span><br><span class="line">    log.info(&quot;菜品分页查询：&#123;&#125;&quot;, dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">    PageResult pageResult = dishService.pageQuery(dishPageQueryDTO);</span><br><span class="line">    return Result.success(pageResult);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 中扩展分页查询方法：</span><br><span class="line">/**</span><br><span class="line"> * 菜品分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param dishPageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现分页查询方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 菜品分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param dishPageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public PageResult pageQuery(DishPageQueryDTO dishPageQueryDTO) &#123;</span><br><span class="line">    PageHelper.startPage(dishPageQueryDTO.getPage(), dishPageQueryDTO.getPageSize());</span><br><span class="line">    Page&lt;DishVO&gt; page = dishMapper.pageQuery(dishPageQueryDTO);</span><br><span class="line">    return new PageResult(page.getTotal(), page.getResult());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishMapper 接口中声明 pageQuery 方法：</span><br><span class="line">/**</span><br><span class="line"> * 菜品分页查询</span><br><span class="line"> *</span><br><span class="line"> * @param dishPageQueryDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">Page&lt;DishVO&gt; pageQuery(DishPageQueryDTO dishPageQueryDTO);</span><br><span class="line"></span><br><span class="line">在 DishMapper.xml 中编写 SQL：</span><br><span class="line">&lt;select id=&quot;pageQuery&quot; resultType=&quot;com.sky.vo.DishVO&quot;&gt;</span><br><span class="line">    select d.*, c.name as categoryName from dish d left join category c on d.category_id = c.id</span><br><span class="line">    &lt;where&gt;</span><br><span class="line">        &lt;if test=&quot;name != null&quot;&gt;</span><br><span class="line">            and d.name like concat(&#x27;%&#x27;, #&#123;name&#125;, &#x27;%&#x27;)</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;categoryId != null&quot;&gt;</span><br><span class="line">            and d.category_id = #&#123;categoryId&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;status != null&quot;&gt;</span><br><span class="line">            and d.status = #&#123;status&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">    &lt;/where&gt;</span><br><span class="line">    order by d.create_time desc</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="功能测试-2"><a href="#功能测试-2" class="headerlink" title="功能测试"></a>功能测试</h3><p>进行前后端联调测试，可以看到所有菜品，也可以输入条件查询，可以切换下一页，成功</p>
<h2 id="删除菜品"><a href="#删除菜品" class="headerlink" title="删除菜品"></a>删除菜品</h2><h3 id="需求分析和设计-3"><a href="#需求分析和设计-3" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line"></span><br><span class="line">可以一次删除一个菜品，也可以批量删除菜品</span><br><span class="line">起售中的菜品不能删除</span><br><span class="line">被套餐关联的菜品不能删除</span><br><span class="line">删除菜品后，关联的口味数据也需要删除掉</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="代码开发-6"><a href="#代码开发-6" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">根据删除菜品的接口定义在 DishController 中创建方法：</span><br><span class="line">/**</span><br><span class="line"> * 菜品批量删除</span><br><span class="line"> *</span><br><span class="line"> * @param ids</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@DeleteMapping</span><br><span class="line">@ApiOperation(&quot;菜品批量删除&quot;)</span><br><span class="line">public Result delete(@RequestParam List&lt;Long&gt; ids) &#123;</span><br><span class="line">    log.info(&quot;菜品批量删除：&#123;&#125;&quot;, ids);</span><br><span class="line">    dishService.deleteBatch(ids);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 接口中声明 deleteBatch 方法：</span><br><span class="line">/**</span><br><span class="line">  * 菜品批量删除</span><br><span class="line">  *</span><br><span class="line">  * @param ids</span><br><span class="line">  */</span><br><span class="line"> void deleteBatch(List&lt;Long&gt; ids);</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现 deleteBatch 方法：</span><br><span class="line">/**</span><br><span class="line"> * 菜品批量删除</span><br><span class="line"> *</span><br><span class="line"> * @param ids</span><br><span class="line"> */</span><br><span class="line">@Transactional</span><br><span class="line">public void deleteBatch(List&lt;Long&gt; ids) &#123;</span><br><span class="line">    ids.forEach(id -&gt; &#123;</span><br><span class="line">        Dish dish = dishMapper.getById(id);</span><br><span class="line"></span><br><span class="line">        //判断当前要删除的菜品状态是否为起售</span><br><span class="line">        if (dish.getStatus() == StatusConstant.ENABLE) &#123;</span><br><span class="line">            //抛出自定义异常并返回错误信息给前端</span><br><span class="line">            throw new DeletionNotAllowedException(MessageConstant.DISH_ON_SALE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    //判断当前要删除的菜品是否关联了套餐</span><br><span class="line">    List&lt;Long&gt; setmealIds = setmealDishMapper.getSetmealIdsByDishIds(ids);  //根据菜品id查询关联的所有套餐id</span><br><span class="line">    if (setmealIds != null &amp;&amp; setmealIds.size() &gt; 0) &#123;</span><br><span class="line">        throw new DeletionNotAllowedException(MessageConstant.DISH_BE_RELATED_BY_SETMEAL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //删除菜品表中的数据</span><br><span class="line">    ids.forEach(id -&gt; &#123;</span><br><span class="line">        dishMapper.deleteById(id);</span><br><span class="line"></span><br><span class="line">        //删除菜品对应的口味数据</span><br><span class="line">        dishFlavorMapper.deleteByDishId(id);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishMapper 中声明 getById 方法，并配置 SQL：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询菜品数据</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@Select(&quot;select * from dish where id = #&#123;id&#125;&quot;)</span><br><span class="line">Dish getById(Long id);</span><br><span class="line"></span><br><span class="line">创建 SetmealDishMapper，声明 getSetmealIdsByDishIds 方法，并在 xml 文件中编写 SQL：</span><br><span class="line">import org.apache.ibatis.annotations.Mapper;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@Mapper</span><br><span class="line">public interface SetmealDishMapper &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据菜品id查询关联的套餐id</span><br><span class="line">     *</span><br><span class="line">     * @param ids</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;Long&gt; getSetmealIdsByDishIds(List&lt;Long&gt; ids);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http: //mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;mapper namespace=&quot;com.sky.mapper.SetmealDishMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=&quot;getSetmealIdsByDishIds&quot; resultType=&quot;java.lang.Long&quot;&gt;</span><br><span class="line">        select setmeal_id from setmeal_dish where dish_id in</span><br><span class="line">        &lt;foreach collection=&quot;ids&quot; separator=&quot;,&quot; open=&quot;(&quot; close=&quot;)&quot; item=&quot;dishId&quot;&gt;</span><br><span class="line">            #&#123;dishId&#125;</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br><span class="line">在 DishMapper 中声明 deleteById 方法并配置 SQL：</span><br><span class="line">/**</span><br><span class="line"> * 根据id删除菜品</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> */</span><br><span class="line">@Delete(&quot;delete from dish where id = #&#123;id&#125;&quot;)</span><br><span class="line">void deleteById(Long id);</span><br><span class="line"></span><br><span class="line">在 DishFlavorMapper 中声明 deleteByDishId 方法并配置 SQL：</span><br><span class="line">/**</span><br><span class="line"> * 根据菜品id删除口味数据</span><br><span class="line"> *</span><br><span class="line"> * @param dishId</span><br><span class="line"> */</span><br><span class="line">@Delete(&quot;delete from dish_flavor where dish_id = #&#123;dishId&#125;&quot;)</span><br><span class="line">void deleteByDishId(Long dishId);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="功能测试-3"><a href="#功能测试-3" class="headerlink" title="功能测试"></a>功能测试</h3><p>通过Swagger接口文档进行测试，通过后再前后端联调测试即可</p>
<h2 id="修改菜品"><a href="#修改菜品" class="headerlink" title="修改菜品"></a>修改菜品</h2><h3 id="需求分析和设计-4"><a href="#需求分析和设计-4" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">根据id查询菜品</span><br><span class="line"></span><br><span class="line">根据类型查询分类（已实现）</span><br><span class="line"></span><br><span class="line">文件上传（已实现）</span><br><span class="line"></span><br><span class="line">修改菜品</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="代码开发-7"><a href="#代码开发-7" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">根据 id 查询菜品接口开发</span><br><span class="line"></span><br><span class="line">在 DishController 中创建 getById 方法：</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 根据id查询菜品和关联的口味数据</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@GetMapping(&quot;/&#123;id&#125;&quot;)</span><br><span class="line">@ApiOperation(&quot;根据id查询菜品和关联的口味数据&quot;)</span><br><span class="line">public Result&lt;DishVO&gt; getById(@PathVariable Long id) &#123;</span><br><span class="line">    log.info(&quot;根据id查询菜品和关联的口味数据：&#123;&#125;&quot;, id);</span><br><span class="line">    return Result.success(dishService.getByIdWithFlavor(id));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 接口中声明 getByIdWithFlavor 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询菜品和关联的口味数据</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line"> </span><br><span class="line">DishVO getByIdWithFlavor(Long id);</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现 getByIdWithFlavor 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id查询菜品和关联的口味数据</span><br><span class="line"> *</span><br><span class="line"> * @param id</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public DishVO getByIdWithFlavor(Long id) &#123;</span><br><span class="line">    //查询菜品表</span><br><span class="line">    Dish dish = dishMapper.getById(id);</span><br><span class="line"></span><br><span class="line">    //查询菜品关联的口味</span><br><span class="line">    List&lt;DishFlavor&gt; dishFlavorList = dishFlavorMapper.getByDishId(id);</span><br><span class="line"></span><br><span class="line">    //封装成VO</span><br><span class="line">    DishVO dishVO = new DishVO();</span><br><span class="line">    BeanUtils.copyProperties(dish, dishVO);</span><br><span class="line">    dishVO.setFlavors(dishFlavorList);</span><br><span class="line"></span><br><span class="line">    return dishVO;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishFlavorMapper 中声明 getByDishId 方法，并配置 SQL：</span><br><span class="line">/**</span><br><span class="line"> * 根据菜品id查询对应的口味</span><br><span class="line"> *</span><br><span class="line"> * @param dishId</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@Select(&quot;select * from dish_flavor where dish_id = #&#123;dishId&#125;&quot;)</span><br><span class="line">List&lt;DishFlavor&gt; getByDishId(Long dishId);</span><br><span class="line"></span><br><span class="line">修改菜品接口开发</span><br><span class="line"></span><br><span class="line">在 DishController 中创建 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 修改菜品</span><br><span class="line"> *</span><br><span class="line"> * @param dishDTO</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PutMapping</span><br><span class="line">@ApiOperation(&quot;修改菜品&quot;)</span><br><span class="line">public Result update(@RequestBody DishDTO dishDTO) &#123;</span><br><span class="line">    log.info(&quot;修改菜品：&#123;&#125;&quot;, dishDTO);</span><br><span class="line">    dishService.updateWithFlavor(dishDTO);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 接口中声明 updateWithFlavor 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id修改菜品和关联的口味</span><br><span class="line"> * @param dishDTO</span><br><span class="line"> */</span><br><span class="line">void updateWithFlavor(DishDTO dishDTO);</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现 updateWithFlavor 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据id修改菜品和关联的口味</span><br><span class="line"> *</span><br><span class="line"> * @param dishDTO</span><br><span class="line"> */</span><br><span class="line">@Transactional</span><br><span class="line">public void updateWithFlavor(DishDTO dishDTO) &#123;</span><br><span class="line">    Dish dish = new Dish();</span><br><span class="line">    BeanUtils.copyProperties(dishDTO, dish);</span><br><span class="line"></span><br><span class="line">    //获取所要修改菜品的id</span><br><span class="line">    Long dishId = dishDTO.getId();</span><br><span class="line"></span><br><span class="line">    //修改菜品表dish</span><br><span class="line">    dishMapper.update(dish);</span><br><span class="line"></span><br><span class="line">    //删除当前菜品关联的口味数据</span><br><span class="line">    dishFlavorMapper.deleteByDishId(dishId);</span><br><span class="line"></span><br><span class="line">    //插入最新的口味数据</span><br><span class="line">    List&lt;DishFlavor&gt; flavors = dishDTO.getFlavors();</span><br><span class="line">    if (flavors != null &amp;&amp; flavors.size() &gt; 0) &#123;</span><br><span class="line">        flavors.forEach(dishFlavor -&gt; &#123;</span><br><span class="line">            dishFlavor.setDishId(dishId);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        //批量插入口味数据</span><br><span class="line">        dishFlavorMapper.insertBatch(flavors);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishMapper 中声明 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据菜品id修改菜品信息</span><br><span class="line"> *</span><br><span class="line"> * @param dish</span><br><span class="line"> */</span><br><span class="line">@AutoFill(OperationType.UPDATE)</span><br><span class="line">void update(Dish dish);</span><br><span class="line"></span><br><span class="line">在 DishMapper.xml 中配置 SQL：</span><br><span class="line">&lt;!--    根据菜品id修改菜品信息--&gt;</span><br><span class="line">&lt;update id=&quot;update&quot;&gt;</span><br><span class="line">    update dish</span><br><span class="line">    &lt;set&gt;</span><br><span class="line">        &lt;if test=&quot;name != null&quot;&gt;</span><br><span class="line">            name = #&#123;name&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;categoryId != null&quot;&gt;</span><br><span class="line">            category_id = #&#123;categoryId&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;price != null&quot;&gt;</span><br><span class="line">            price = #&#123;price&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;image != null&quot;&gt;</span><br><span class="line">            image = #&#123;image&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;description != null&quot;&gt;</span><br><span class="line">            description = #&#123;description&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;status !=  null&quot;&gt;</span><br><span class="line">            status = #&#123;status&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;updateTime != null&quot;&gt;</span><br><span class="line">            update_time = #&#123;updateTime&#125;,</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">        &lt;if test=&quot;updateUser != null&quot;&gt;</span><br><span class="line">            update_user = #&#123;updateUser&#125;</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">    &lt;/set&gt;</span><br><span class="line">    where id = #&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="功能测试-4"><a href="#功能测试-4" class="headerlink" title="功能测试"></a>功能测试</h3><p>直接进行前后端联调比较方便，可以给没有图片的菜品修改图片</p>
<h2 id="菜品启售停售"><a href="#菜品启售停售" class="headerlink" title="菜品启售停售"></a>菜品启售停售</h2><h3 id="需求分析和设计-5"><a href="#需求分析和设计-5" class="headerlink" title="需求分析和设计"></a>需求分析和设计</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">业务规则：</span><br><span class="line"></span><br><span class="line">菜品停售，则包含菜品的套餐同时停售</span><br><span class="line">数据库设计：</span><br><span class="line">涉及 dish、setmeal 和 setmeal_dish 三个表</span><br></pre></td></tr></table></figure>

<h3 id="代码开发-8"><a href="#代码开发-8" class="headerlink" title="代码开发"></a>代码开发</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">在 DishController 中创建 startOrStop 方法:</span><br><span class="line">/**</span><br><span class="line"> * 菜品启售停售</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span><br><span class="line">@ApiOperation(&quot;菜品启售停售&quot;)</span><br><span class="line">public Result startOrStop(@PathVariable Integer status, Long id) &#123;</span><br><span class="line">    log.info(&quot;菜品启售停售：&#123;&#125;&quot;, status);</span><br><span class="line">    dishService.startOrStop(status, id);</span><br><span class="line">    return Result.success();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 DishService 中声明 startOrStop 方法：</span><br><span class="line">/**</span><br><span class="line"> * 修改菜品状态</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @param id</span><br><span class="line"> */</span><br><span class="line">void startOrStop(Integer status, Long id);</span><br><span class="line"></span><br><span class="line">在 DishServiceImpl 中实现 startOrStop 方法：</span><br><span class="line">/**</span><br><span class="line"> * 修改菜品状态</span><br><span class="line"> *</span><br><span class="line"> * @param status</span><br><span class="line"> * @param id</span><br><span class="line"> */</span><br><span class="line">@Transactional	//涉及修改的操作加入事务管理比较好</span><br><span class="line">public void startOrStop(Integer status, Long id) &#123;</span><br><span class="line">    Dish dish = dishMapper.getById(id);//获取菜品对象</span><br><span class="line">    dish.setStatus(status);//设置菜品状态</span><br><span class="line">    dishMapper.update(dish);//更新菜品信息</span><br><span class="line"></span><br><span class="line">    //如果是停售操作, 则需要将菜品关联的套餐一并停售</span><br><span class="line">    if (status.equals(StatusConstant.DISABLE)) &#123;</span><br><span class="line">        List&lt;Long&gt; dishIds = new ArrayList&lt;&gt;();</span><br><span class="line">        dishIds.add(id);</span><br><span class="line"></span><br><span class="line">        //根据菜品id查询关联的所有套餐id</span><br><span class="line">        List&lt;Long&gt; setmealIds = setmealDishMapper.getSetmealIdsByDishIds(dishIds);</span><br><span class="line"></span><br><span class="line">        if (setmealIds != null &amp;&amp; setmealIds.size() &gt; 0) &#123;</span><br><span class="line">            setmealIds.forEach(setmealId -&gt; &#123;</span><br><span class="line">                Setmeal setmeal = Setmeal.builder()</span><br><span class="line">                        .id(setmealId)</span><br><span class="line">                        .status(StatusConstant.DISABLE)</span><br><span class="line">                        .build();</span><br><span class="line">                setmealMapper.update(setmeal);  //根据套餐id修改套餐信息</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在 SetmealMapper 中声明 update 方法：</span><br><span class="line">/**</span><br><span class="line"> * 根据套餐id修改套餐信息</span><br><span class="line"> *</span><br><span class="line"> * @param setmeal</span><br><span class="line"> */</span><br><span class="line">@AutoFill(OperationType.UPDATE)</span><br><span class="line">void update(Setmeal setmeal);</span><br><span class="line"></span><br><span class="line">新建 SetmealMapper.xml，并在其中配置对应的 SQL：</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http: //mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt;</span><br><span class="line"></span><br><span class="line">&lt;mapper namespace=&quot;com.sky.mapper.SetmealMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--    根据套餐id修改套餐信息--&gt;</span><br><span class="line">    &lt;update id=&quot;update&quot;&gt;</span><br><span class="line">        update setmeal</span><br><span class="line">        &lt;set&gt;</span><br><span class="line">            &lt;if test=&quot;categoryId != null&quot;&gt;</span><br><span class="line">                category_id = #&#123;categoryId&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;name != null&quot;&gt;</span><br><span class="line">                name = #&#123;name&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;price != null&quot;&gt;</span><br><span class="line">                price = #&#123;price&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;status != null&quot;&gt;</span><br><span class="line">                status = #&#123;status&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;description != null&quot;&gt;</span><br><span class="line">                description = #&#123;description&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;image != null&quot;&gt;</span><br><span class="line">                image = #&#123;image&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;updateTime != null&quot;&gt;</span><br><span class="line">                update_time = #&#123;updateTime&#125;,</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">            &lt;if test=&quot;updateUser != null&quot;&gt;</span><br><span class="line">                update_user = #&#123;updateUser&#125;</span><br><span class="line">            &lt;/if&gt;</span><br><span class="line">        &lt;/set&gt;</span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="功能测试-5"><a href="#功能测试-5" class="headerlink" title="功能测试"></a>功能测试</h3><p>通过swagger接口文档和前后端联调进行功能测试</p>
</body></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://tang7777777.com">Tang_7777777</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://tang7777777.com/2024/09/08/CangQWoking/">http://tang7777777.com/2024/09/08/CangQWoking/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://tang7777777.com" target="_blank">Tang_7777777 的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java%E5%BC%80%E5%8F%91/">Java开发</a></div><div class="post_share"><div class="social-share" data-image="/img/check.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>联系我</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/weixin.jpg" target="_blank"><img class="post-qr-code-img" src="/img/weixin.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/09/TheBegin/" title="一些念头"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">一些念头</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/04/GameMadeDaily/" title="基于C++的EasyX开发的简单割草小游戏 的笔记"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">基于C++的EasyX开发的简单割草小游戏 的笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/09/20/CangQWoking2/" title="苍穹外卖 —— 开发日记(其二)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-20</div><div class="title">苍穹外卖 —— 开发日记(其二)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/check.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Tang_7777777</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">9</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Tang77777777"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">有bug或者疑问联系我 微信：wxid_vfhlv80p0bkd22</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#nginx-%E7%9A%84%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">nginx 的反向代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%8F%91%E9%80%81%E7%9A%84%E8%AF%B7%E6%B1%82%EF%BC%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%AF%B7%E6%B1%82%E5%88%B0%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E7%9A%84%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">前端发送的请求，是如何请求到后端服务的？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8MD5%E4%BF%A1%E6%81%AF%E6%91%98%E8%A6%81%E7%AE%97%E6%B3%95%E5%AE%8C%E5%96%84%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="toc-number">2.</span> <span class="toc-text">使用MD5信息摘要算法完善登录功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3"><span class="toc-number">3.</span> <span class="toc-text">导入接口文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Swagger%E6%96%B9%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">使用Swagger方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9D%97"><span class="toc-number">5.</span> <span class="toc-text">员工管理模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">5.1.</span> <span class="toc-text">需求分析：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%EF%BC%9A"><span class="toc-number">5.2.</span> <span class="toc-text">设计：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95"><span class="toc-number">5.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%91%98%E5%B7%A5%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">员工分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1"><span class="toc-number">6.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="toc-number">6.2.</span> <span class="toc-text">代码开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%A6%81%E7%94%A8%E5%91%98%E5%B7%A5%E8%B4%A6%E5%8F%B7"><span class="toc-number">7.</span> <span class="toc-text">启动禁用员工账号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">7.1.</span> <span class="toc-text">需求分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-1"><span class="toc-number">7.2.</span> <span class="toc-text">代码开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%91%98%E5%B7%A5"><span class="toc-number">8.</span> <span class="toc-text">编辑员工</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1"><span class="toc-number">8.1.</span> <span class="toc-text">需求分析与设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-2"><span class="toc-number">8.2.</span> <span class="toc-text">代码开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AEid%E6%9F%A5%E8%AF%A2%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91"><span class="toc-number">8.2.1.</span> <span class="toc-text">根据id查询员工信息接口开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91"><span class="toc-number">8.2.2.</span> <span class="toc-text">编辑员工信息接口开发</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%88%86%E7%B1%BB%E6%A8%A1%E5%9D%97%E5%8A%9F%E8%83%BD%E4%BB%A3%E7%A0%81"><span class="toc-number">9.</span> <span class="toc-text">导入分类模块功能代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90-1"><span class="toc-number">9.1.</span> <span class="toc-text">需求分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E5%AD%97%E6%AE%B5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85"><span class="toc-number">10.</span> <span class="toc-text">公共字段自动填充</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="toc-number">10.1.</span> <span class="toc-text">问题分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%80%9D%E8%B7%AF"><span class="toc-number">10.2.</span> <span class="toc-text">解决思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-3"><span class="toc-number">10.3.</span> <span class="toc-text">代码开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%93%81"><span class="toc-number">11.</span> <span class="toc-text">新增菜品</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-1"><span class="toc-number">11.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-4"><span class="toc-number">11.2.</span> <span class="toc-text">代码开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%93%81%E6%8E%A5%E5%8F%A3"><span class="toc-number">11.2.1.</span> <span class="toc-text">开发新增菜品接口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-1"><span class="toc-number">11.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E5%93%81%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">12.</span> <span class="toc-text">菜品分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-2"><span class="toc-number">12.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-5"><span class="toc-number">12.2.</span> <span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-2"><span class="toc-number">12.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%8F%9C%E5%93%81"><span class="toc-number">13.</span> <span class="toc-text">删除菜品</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-3"><span class="toc-number">13.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-6"><span class="toc-number">13.2.</span> <span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-3"><span class="toc-number">13.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%8F%9C%E5%93%81"><span class="toc-number">14.</span> <span class="toc-text">修改菜品</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-4"><span class="toc-number">14.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-7"><span class="toc-number">14.2.</span> <span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-4"><span class="toc-number">14.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8F%9C%E5%93%81%E5%90%AF%E5%94%AE%E5%81%9C%E5%94%AE"><span class="toc-number">15.</span> <span class="toc-text">菜品启售停售</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90%E5%92%8C%E8%AE%BE%E8%AE%A1-5"><span class="toc-number">15.1.</span> <span class="toc-text">需求分析和设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91-8"><span class="toc-number">15.2.</span> <span class="toc-text">代码开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95-5"><span class="toc-number">15.3.</span> <span class="toc-text">功能测试</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/20/CangQWoking2/" title="苍穹外卖 —— 开发日记(其二)">苍穹外卖 —— 开发日记(其二)</a><time datetime="2024-09-20T12:38:29.000Z" title="发表于 2024-09-20 20:38:29">2024-09-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/09/TheBegin/" title="一些念头">一些念头</a><time datetime="2024-09-09T14:27:32.000Z" title="发表于 2024-09-09 22:27:32">2024-09-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/08/CangQWoking/" title="苍穹外卖 —— 开发日记(其一)">苍穹外卖 —— 开发日记(其一)</a><time datetime="2024-09-08T06:59:51.000Z" title="发表于 2024-09-08 14:59:51">2024-09-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/09/04/GameMadeDaily/" title="基于C++的EasyX开发的简单割草小游戏 的笔记">基于C++的EasyX开发的简单割草小游戏 的笔记</a><time datetime="2024-09-04T14:08:46.000Z" title="发表于 2024-09-04 22:08:46">2024-09-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/08/31/disan/" title="关于齐泽克—— 从“做自己”到大他者的凝视">关于齐泽克—— 从“做自己”到大他者的凝视</a><time datetime="2024-08-31T13:51:15.000Z" title="发表于 2024-08-31 21:51:15">2024-08-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By Tang_7777777</div><div class="footer_custom_text">欢迎来到<a href= "https://tang7777777.com/">Tang_7777777的博客</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>